{% extends 'base.html' %}

{% block title %}Projets dynamiques{% endblock %}

{% block content %}
<section id="projets-container">
    <h2>Chargement des projets...</h2>
</section>

<script>
fetch("/api/projets")
    .then(response => response.json())
    .then(data => {
        const section = document.getElementById("projets-container");
        section.innerHTML = `
            <h2>Mes projets</h2>
            <form id="ajout-projet-form">
                <h3>Ajouter un projet</h3>
                <input type="text" id="titre" placeholder="Titre" required>
                <input type="text" id="annee" placeholder="Année" required>
                <textarea id="description" placeholder="Description" required></textarea>
                <button type="submit">Ajouter</button>
            </form>
            <ul>
                ${data.map(p => `
                    <li>
                        <h3>${p.titre} <small>(${p.année})</small></h3>
                        <p>${p.description}</p>
                    </li>
                `).join('')}
            </ul>
        `;
        document.getElementById("ajout-projet-form").addEventListener("submit", function(e) {
            e.preventDefault();
            alert("Le formulaire fonctionne (envoi non encore connecté à l'API).");
        });
    })
    .catch(() => {
        document.getElementById("projets-container").innerHTML = "<p>Erreur lors du chargement.</p>";
    });
</script>
{% endblock %}